# 基于深度学习的人民币智能识别系统：阶段性成果展示-框架搭建和跑通

## 项目概述：面向金融科技的商业化应用

- **金融场景应用**：银行自动化收银系统、智能柜台、ATM机纸币识别，提升业务处理效率，降低人工成本
- **智能零售革新**：无人商店自动结算、智能收银台、自动售货机升级，推动零售业数字化转型
- **安防监管升级**：大额现金交易监控、反洗钱识别、可疑交易预警，增强金融安全防护能力
- **技术服务平台**：提供标准化API接口、软件即服务解决方案、定制化开发服务，赋能行业智能化升级

## 当前完成情况：基础框架搭建

### 机器视觉流水线框架
- ✅ **图像采集模块**：基于FFmpeg的跨平台视频流获取
  - 实际代码：`try-camear.py` 使用UDP地址 `"udp://127.0.0.1:11111"` 接收视频流
- ✅ **预处理管道**：224×224像素标准化、色彩空间转换、数据归一化
  - 实际代码：`rmb_live_classifier.py:29-43` 的 `preprocess_image()` 函数实现BGR转RGB、尺寸调整、归一化处理
- ✅ **特征提取网络**：三层卷积神经网络基础架构搭建
  - 实际代码：`rmb_classifier.py:47-59` 实现Conv2D(32)→MaxPooling2D→Conv2D(64)→MaxPooling2D→Conv2D(128)→MaxPooling2D
- ✅ **分类器模块**：Softmax多类别分类输出
  - 实际代码：`rmb_classifier.py:57-58` 使用Dense(256) + Dropout(0.5) + Dense(num_classes, activation='softmax')
- ✅ **后处理系统**：置信度评估、结果可视化
  - 实际代码：`rmb_live_classifier.py:110-138` 实现实时显示识别结果、置信度、FPS等可视化信息

### 深度学习训练框架
- ✅ **数据加载器**：TensorFlow数据管道自动化处理
  - 实际代码：`rmb_classifier.py:15-43` 使用 `tf.keras.utils.image_dataset_from_directory()` 自动加载数据
  - 实际参数：图像尺寸224×224，批次大小32，验证分割比例20%
- ✅ **模型定义**：Keras序列模型架构
  - 实际代码：`rmb_classifier.py:46-67` 完整的Sequential模型定义和编译配置
- ✅ **训练循环**：Adam自适应优化器、交叉熵损失函数
  - 实际代码：`rmb_classifier.py:61-65` 使用optimizer='adam'，loss='sparse_categorical_crossentropy'
- ✅ **验证机制**：20%数据分割验证、性能监控
  - 实际代码：`rmb_classifier.py:27-34` 训练集和验证集分离，seed=123保证可重现性
- ✅ **模型持久化**：H5格式模型保存与加载
  - 实际代码：`rmb_classifier.py:86` 保存为 `rmb_classifier.h5`（文件大小255MB）
  - 实际代码：`rmb_live_classifier.py:19-27` 实现模型加载和错误处理

### 实时推理系统
- ✅ **视频流接收**：UDP协议实时图像传输
  - 实际代码：`rmb_live_classifier.py:70-87` 使用 `cv2.VideoCapture(udp_address)` 接收流
- ✅ **推理引擎**：模型加载与批量预测
  - 实际代码：`rmb_live_classifier.py:45-66` 的 `predict()` 方法实现实时推理
- ✅ **性能监控**：帧率计算、延迟测量
  - 实际代码：`rmb_live_classifier.py:91-108` 实现FPS计算器，每10帧更新一次显示
- ✅ **结果展示**：OpenCV实时可视化界面
  - 实际代码：`rmb_live_classifier.py:111-138` 绘制识别结果、置信度、FPS等实时信息

### 数据集管理框架
- ✅ **数据结构**：六类别人民币图像目录组织
  - 实际目录：`RMB-Dataset/RMBDataset/` 包含1元、5元、10元、20元、50元、100元六个子目录
  - 实际数量：总计786张图片，各类别分布均衡（1元:134张、5元:98张、10元:156张、20元:99张、50元:167张、100元:132张）
- ✅ **版本控制**：Git数据集版本管理
  - 实际配置：`RMB-Dataset/` 目录包含 `.git/` 版本控制
- ✅ **基础标注**：按面额分类的监督学习数据
  - 实际文件命名：如 `1-100.jpg`、`10-101.jpg` 等按类别编号命名

## 核心技术挑战：人民币识别的特殊难点

### 复杂的成像条件挑战
- **光照变化**：不同环境光照条件下的色彩失真
- **角度变化**：拍摄角度导致的透视变形
- **遮挡问题**：部分遮挡、折叠、污损的影响
- **背景干扰**：复杂背景对主体识别的干扰

### 人民币固有的设计噪声干扰严重
- **复杂纹理图案**：人民币本身具有复杂的多层纹理、防伪图案和背景设计
- **高密度细节**：微缩文字、底纹、防伪线等密集细节形成的视觉噪声
- **色彩相似性**：不同面额间相似的主色调，增加区分难度
- **版式变化**：不同年份、版本的细微设计差异
- **防伪特征干扰**：水印、安全线、凹凸印刷等防伪技术对识别的干扰

### 传统方法的局限性
- **特征工程困难**：手工设计特征难以应对复杂的设计噪声
- **模板匹配失效**：固定模板无法适应版式变化和复杂纹理
- **鲁棒性不足**：传统算法对固有噪声敏感度高
- **泛化能力差**：针对特定条件训练，适应性有限

### 深度学习的解决方案优势
- **自动特征提取**：卷积神经网络自动学习多层次特征表示，区分有效信息与噪声
- **强鲁棒性**：对复杂纹理、色彩变化具有较强容忍度
- **端到端训练**：从原始像素到分类结果的直接映射
- **持续学习能力**：可通过数据扩充不断提升性能

## 技术选型考量

### 深度学习框架：TensorFlow/Keras
- **机器视觉生态**：丰富的预训练模型和工具链
- **部署友好性**：支持多种平台部署和优化
- **调试便利性**：TensorBoard可视化训练过程
- **实际应用**：项目中使用 `import tensorflow as tf` 和 `from tensorflow import keras`

### 视觉处理库：OpenCV
- **功能完整性**：涵盖图像处理全流程
- **性能优化**：针对实时处理的优化算法
- **跨平台兼容**：WSL2环境下的稳定表现
- **实际应用**：项目中使用 `import cv2` 进行视频流处理和图像显示

### 视频流方案：FFmpeg + UDP
- **跨平台桥接**：Windows宿主机与WSL2通信
- **实时性保证**：低延迟视频传输机制
- **格式灵活性**：支持多种编码和参数调整
- **实际应用**：宿主机使用 `ffmpeg -f dshow -i video="Integrated Webcam" -vcodec mjpeg -r 10 -f mjpeg udp://127.0.0.1:11111` 推流

### 开发环境：WSL2
- **GPU加速**：CUDA支持提升训练效率
- **工具链完整**：GNU/Linux开发环境
- **生态兼容**：机器视觉库的良好支持
- **实际应用**：项目运行在WSL2环境，平台信息为 `Linux 6.6.87.2-microsoft-standard-WSL2`

## 发展目标

### 核心技术突破
- **噪声鲁棒性**：开发针对人民币固有设计噪声的专用训练策略
- **多模态融合**：集成红外、紫外特征进行真伪检测
- **目标检测**：复杂场景中的精确定位与分割
- **序列分析**：视频流中的时序特征挖掘

### 系统性能提升
- **实时优化**：模型量化、推理加速，达到工业级性能
- **边缘部署**：移动端和嵌入式设备适配
- **云端协同**：边缘-云端协同推理架构
- **自动化运维**：模型更新与监控系统

## 项目文件结构

```
.
├── README.md                           # 项目说明文档
├── rmb_classifier.py                   # 模型训练脚本
├── rmb_live_classifier.py              # 实时识别应用
├── rmb_classifier.h5                   # 训练好的模型文件 (255MB)
├── try-camear.py                       # 视频流测试脚本
├── try-tensorflow.py                   # TensorFlow环境测试
├── machine-vision-program/             # Python虚拟环境
└── RMB-Dataset/                        # 训练数据集
    └── RMBDataset/
        ├── 1/                          # 1元纸币图像 (134张)
        ├── 5/                          # 5元纸币图像 (98张)
        ├── 10/                         # 10元纸币图像 (156张)
        ├── 20/                         # 20元纸币图像 (99张)
        ├── 50/                         # 50元纸币图像 (167张)
        └── 100/                        # 100元纸币图像 (132张)
```

## 快速开始

### 环境准备
1. 激活Python虚拟环境：`source machine-vision-program/bin/activate`
2. 安装依赖：`pip install tensorflow opencv-python numpy`

### 模型训练
```bash
python rmb_classifier.py
```

### 实时识别
1. 在Windows宿主机启动FFmpeg推流：
   ```bash
   ffmpeg -f dshow -i video="Integrated Webcam" -vcodec mjpeg -r 10 -f mjpeg udp://127.0.0.1:11111
   ```
2. 在WSL2中运行实时识别：
   ```bash
   python rmb_live_classifier.py
   ```

## 技术参数

- **模型架构**：3层卷积神经网络
- **输入尺寸**：224×224像素
- **批次大小**：32
- **训练周期**：1000轮
- **学习率**：Adam自适应
- **数据集**：786张图像，6个类别
- **模型大小**：255MB
- **视频流协议**：UDP
- **帧率目标**：10 FPS
- **置信度阈值**：30%

## 阶段性成果总结

本项目成功搭建了完整的人民币智能识别系统框架，实现了从数据预处理、模型训练到实时推理的全流程。系统采用三层卷积神经网络架构，在786张人民币图像数据集上完成训练，生成的255MB模型文件能够准确识别1元、5元、10元、20元、50元、100元六个面额。通过FFmpeg+UDP的视频流方案，实现了跨平台的实时识别功能，为后续的算法优化和产业化应用奠定了坚实基础。