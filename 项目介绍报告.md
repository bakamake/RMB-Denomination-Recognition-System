# RMB人民币面额识别系统 - 项目介绍报告

## 项目概述

本项目是一个基于计算机视觉和深度学习技术的人民币面额实时识别系统。系统采用PyQt6构建图形用户界面，结合OpenCV进行图像处理，能够实时从摄像头捕获视频流，并对纸币进行特征检测和面额识别。

**核心功能：** 实时视频流处理、多种图像处理算法、纸币特征分析、面额自动识别

## 技术架构

### 核心技术栈
- **Python 3** - 主要编程语言
- **PyQt6** - 图形用户界面框架
- **OpenCV** - 计算机视觉库
- **NumPy** - 数值计算支持

### 系统架构设计

```
┌─────────────────────────────────────────┐
│           MainWindow (主窗口)            │
│  ┌──────────────┐  ┌──────────────────┐ │
│  │  视频显示区   │  │   控制面板区      │ │
│  │              │  │                  │ │
│  │ 原始视频显示  │  │ - 摄像头控制     │ │
│  │ 处理视频显示  │  │ - 模式选择       │ │
│  └──────────────┘  │ - 参数调节       │ │
│                    │ - 信息显示       │ │
│                    └──────────────────┘ │
└─────────────────────────────────────────┘
           ▲                    ▲
           │                    │
           ▼                    ▼
┌──────────────────┐  ┌──────────────────┐
│ CameraThread     │  │ ImageProcessor   │
│ (摄像头线程)      │  │ (图像处理类)     │
│                  │  │                  │
│ - 视频捕获       │  │ - 11种处理算法   │
│ - FPS计算        │  │ - 特征检测       │
│ - 信号发射       │  │ - 面额识别       │
└──────────────────┘  └──────────────────┘
```

## 功能模块详解

### 1. 摄像头模块 (CameraThread)

**功能：** 独立的摄像头读取线程，避免阻塞UI主线程

**关键特性：**
- 使用`cv2.VideoCapture(0)`捕获摄像头视频流
- 实时FPS计算和显示（每30帧更新一次）
- 通过PyQt信号机制将帧数据发送到主线程
- 支持优雅的启动和停止

**核心代码位置：** `qt_camera.py:21-73`

```python
class CameraThread(QThread):
    """摄像头读取线程，避免阻塞UI"""
    frame_ready = pyqtSignal(np.ndarray)  # 发出frame就绪信号
```

### 2. 图像处理模块 (ImageProcessor)

**功能：** 封装所有图像处理算法，提供静态方法处理视频帧

#### 2.1 边缘检测算法

**Canny边缘检测**
- **功能：** 检测图像中的边缘信息
- **参数：** 可调阈值1(0-300)和阈值2(0-300)
- **应用：** 纸币轮廓提取、细节分析

**多级Canny融合**
- **功能：** 结合强弱边缘，突出主要轮廓线
- **算法：** 弱边缘保留长轮廓(>30像素)，强边缘全部保留
- **优势：** 减少噪声，突出主体结构

**绿色边缘增强**
- **功能：** 在原图上叠加绿色边缘标记
- **用途：** 直观显示边缘位置，便于调试和分析

#### 2.2 分割算法

**GrabCut前景分割**
- **功能：** 基于交互式前景提取算法
- **优化：** 迭代次数从5次降至2次，提高处理速度
- **策略：** 每10帧处理一次，使用结果缓存，避免卡顿
- **适用场景：** 精确的前景提取

**快速颜色分割**
- **功能：** 基于人民币颜色特征的快速分割
- **颜色空间：** HSV（更稳定的光照适应性）
- **颜色范围：**
  - 浅黄色：H(15-85), S(30-255), V(30-255)
  - 深色部分：H(0-180), S(0-255), V(150-255)
- **优势：** 处理速度快，适合实时应用

#### 2.3 特征检测算法

**Harris角点检测**
- **功能：** 检测图像中的角点特征
- **参数：** blockSize=2, ksize=3, k=0.04
- **可视化：** 红色标记角点位置

**Shi-Tomasi角点检测**
- **功能：** 改进的角点检测算法
- **参数：** 最大角点数100，品质因子0.01，最小距离10
- **可视化：** 蓝色小圆点标记

**ORB特征检测**
- **功能：** 检测图像中的Oriented FAST and Rotated BRIEF特征
- **参数：** 最大特征点数1000
- **可视化：** 绿色标记特征点
- **用途：** 尺度旋转不变的特征描述

**轮廓检测**
- **功能：** 检测并标注图像轮廓
- **过滤条件：** 只显示面积大于100的轮廓
- **可视化：** 绿色轮廓线，蓝色轮廓编号
- **几何分析：** 计算轮廓面积和重心

#### 2.4 纸币特征检测

**综合特征分析** (`detect_bill_features`)
- **检测内容：**
  - Harris角点数量
  - Shi-Tomasi角点数量
  - ORB特征点数量
  - 轮廓数量
  - 长宽比
  - 面积占比

**特征计算流程：**
1. 转换为灰度图像
2. 应用多种角点检测算法
3. 提取ORB特征点
4. 查找并分析主要轮廓
5. 计算几何特征（长宽比、面积占比）

### 3. 面额识别模块

**识别原理：** 基于特征匹配的规则算法

**识别特征：**
- **长宽比：** 不同面额纸币的典型长宽比
- **面积占比：** 纸币在画面中的面积比例
- **角点数量：** 纸币纹理特征形成的角点
- **特征点数量：** ORB算法检测到的特征点

**各面额特征范围：**

| 面额 | 长宽比范围 | 面积占比范围 | 角点范围 | 特征点范围 |
|------|-----------|-------------|----------|-----------|
| 1元  | 1.5-1.8   | 0.15-0.25   | 15-40    | 50-150    |
| 5元  | 1.5-1.8   | 0.15-0.25   | 15-40    | 50-150    |
| 10元 | 1.7-2.0   | 0.20-0.30   | 20-50    | 80-200    |
| 20元 | 1.7-2.0   | 0.20-0.30   | 20-50    | 70-200    |
| 50元 | 1.75-2.05 | 0.22-0.32   | 20-55    | 80-220    |
| 100元| 1.9-2.15  | 0.30-0.38   | 35-65    | 140-280   |

**匹配算法：**
- 每个特征维度25分，总分100分
- 四个维度均匹配得满分100分
- 阈值设定为5分（宽松模式，提高识别率）

### 4. 图形用户界面 (MainWindow)

**布局设计：** 左侧视频显示 + 右侧控制面板

#### 4.1 视频显示区域
- **原始视频显示：** 实时显示摄像头画面
- **处理后视频显示：** 显示应用算法后的结果
- **尺寸：** 640x480像素
- **样式：** 黑色边框，白色提示文字

#### 4.2 控制面板区域

**摄像头控制组**
- 开始摄像头按钮
- 停止摄像头按钮
- 状态指示

**处理模式选择组**
- 下拉菜单：11种处理模式
- 模式信息显示
- 实时状态更新

**Canny边缘参数组**
- 阈值1滑块（0-300）
- 阈值2滑块（0-300）
- 动态显示当前值
- 按需显示（仅在Canny模式下显示）

**详细信息组**
- 文本编辑框（只读）
- 显示特征检测结果
- 显示面额识别结果
- 高度限制200像素

**系统日志组**
- 文本编辑框（只读）
- 记录操作日志
- 显示FPS信息
- 高度限制150像素

### 5. 处理模式说明

系统提供11种不同的图像处理模式：

1. **原始视频** - 显示未处理的摄像头画面
2. **Canny边缘检测** - 标准边缘检测算法，可调阈值
3. **绿色边缘增强** - 在原图上叠加绿色边缘标记
4. **多级Canny融合** - 结合强弱边缘，减少噪声
5. **GrabCut分割** - 交互式前景提取，每10帧更新
6. **快速颜色分割** - 基于人民币颜色的快速分割
7. **纸币特征检测** - 综合特征检测和分析
8. **面额识别** - 基于特征匹配的面额预测
9. **Harris角点检测** - 角点检测，红色标记
10. **ORB特征检测** - 特征点检测，绿色标记
11. **轮廓检测** - 轮廓检测，绿色轮廓+蓝色编号

## 性能优化策略

### 1. 多线程架构
- **摄像头线程：** 独立线程处理视频捕获，避免UI阻塞
- **信号槽机制：** 使用PyQt的信号槽进行线程间通信
- **异步处理：** 图像处理在主线程完成，确保界面响应

### 2. 帧率优化
- **GrabCut跳帧处理：** 每10帧处理一次GrabCut，避免计算过载
- **结果缓存：** 缓存上次GrabCut结果，帧间复用
- **FPS监控：** 实时显示帧率，便于性能评估

### 3. 内存管理
- **及时释放：** 线程停止时释放摄像头资源
- **信号断开：** 关闭事件中正确断开信号连接
- **缓存清理：** 模式切换时清理临时缓存

## 使用说明

### 启动系统
```bash
python qt_camera.py
```

### 操作流程
1. 点击"开始摄像头"启动视频流
2. 从下拉菜单选择处理模式
3. 调整参数（如Canny阈值）
4. 观察左侧原始视频和右侧处理结果
5. 查看右侧详细信息和系统日志
6. 点击"停止摄像头"结束程序

### 参数调节
- **Canny阈值：** 通过滑块实时调整边缘检测灵敏度
- **模式切换：** 立即生效，无需重启
- **信息查看：** 详细信息面板实时更新检测结果

## 技术亮点

### 1. 算法多样性
- 集成多种经典计算机视觉算法
- 涵盖边缘检测、特征提取、图像分割等领域
- 适合不同场景的图像处理需求

### 2. 实时性能
- 多线程架构保证界面流畅
- 优化的处理策略减少计算量
- 缓存机制避免重复计算

### 3. 用户体验
- 直观的可视化界面
- 实时参数调节
- 丰富的状态反馈

### 4. 扩展性
- 模块化设计，易于添加新算法
- 清晰的代码结构，便于维护
- 静态方法封装，便于复用

## 应用场景

1. **金融行业：** 银行柜台纸币清点
2. **零售行业：** 自动收银系统
3. **教育领域：** 计算机视觉教学演示
4. **安防领域：** 自动识别系统
5. **科研用途：** 特征提取算法研究

## 改进方向

### 1. 深度学习增强
- 集成CNN模型提高识别准确率
- 使用YOLO等目标检测算法
- 训练专用的人民币识别模型

### 2. 多面额支持
- 支持更多国家和地区货币
- 添加假币识别功能
- 残缺纸币识别

### 3. 硬件优化
- 支持工业相机
- GPU加速处理
- 嵌入式设备部署

### 4. 算法改进
- 自适应阈值调整
- 光照补偿算法
- 鲁棒性增强

## 总结

本项目成功实现了一个功能完整的人民币面额识别系统，具有以下特点：

✅ **功能完整：** 涵盖视频采集、图像处理、特征检测、面额识别全流程
✅ **性能优良：** 多线程架构保证实时性，优化策略提升处理速度
✅ **界面友好：** PyQt6构建的直观GUI，操作简便
✅ **算法丰富：** 11种图像处理算法，满足不同需求
✅ **易于扩展：** 模块化设计，便于添加新功能

该系统可以作为人民币识别的基线方案，为进一步的深度学习改进奠定基础。在实际应用中，建议结合具体场景进行参数调优和算法选择。

---

**项目文件：** qt_camera.py
**代码行数：** 808行
**开发语言：** Python 3
**开发时间：** 2025年
